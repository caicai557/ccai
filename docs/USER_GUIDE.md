# 用户使用手册

本手册面向日常使用者，目标是让你从零开始完成安装、配置和首个任务执行。

## 1. 系统安装指南

### 1.1 环境要求

- Node.js 18 及以上
- pnpm 8 及以上
- 本地可访问 Telegram 网络

### 1.2 安装步骤

1. 进入项目根目录并安装依赖：

```bash
pnpm install
```

2. 复制环境变量模板：

```bash
cp backend/.env.example backend/.env
cp frontend/.env.example frontend/.env
```

3. 编辑 `backend/.env`，至少填写以下项：
- `TELEGRAM_API_ID`
- `TELEGRAM_API_HASH`
- `ENCRYPTION_KEY`

4. 启动开发环境：

```bash
pnpm dev
```

5. 打开前端：
- 前端地址：`http://localhost:5173`
- 后端地址：`http://localhost:3000`

## 2. 功能使用说明

### 2.1 添加账号

1. 打开“账号管理”页面。  
2. 选择“手机号登录”或“导入会话文件”。  
3. 手机号登录需按提示输入验证码；若开启两步验证，再输入密码。

### 2.2 添加目标（群组/频道）

1. 打开“目标管理”。  
2. 选择目标类型（群组或频道）。  
3. 填入 Telegram ID 和名称并保存。

### 2.3 创建模板

1. 打开“模板管理”。  
2. 选择分类（群组消息/频道评论）。  
3. 填写模板内容并保存。

### 2.4 创建并启动任务

1. 打开“任务管理”。  
2. 创建任务并选择账号、目标、模板和执行参数。  
3. 点击“启动”，观察状态和执行历史。

### 2.5 查看日志和统计

- “日志查看”可按级别、账号、任务过滤。  
- “仪表板”可查看账号、任务、执行成功率等概览信息。

## 3. 常见问题解答

### Q1：后端启动成功但页面提示接口失败？

- 检查 `backend/.env` 是否完整。  
- 检查后端端口是否为 `3000`，前端 `VITE_API_BASE_URL` 是否一致。  
- 访问 `http://localhost:3000/health`，确认返回 `status: ok`。

### Q2：账号添加后状态一直离线？

- 确认 Telegram 凭证正确。  
- 检查网络是否可访问 Telegram。  
- 打开“日志查看”，筛选 `error` 级别查看失败原因。

### Q3：任务启动后没有实时更新？

- 检查前端 `VITE_WS_URL` 是否指向 `ws://localhost:3000`。  
- 检查浏览器控制台是否有 WebSocket 连接错误。  
- 后端日志中确认有 `WebSocket客户端已连接`。

### Q4：数据库文件在哪？

- 默认在 `backend/data/telegram-manager.db`。  
- 迁移或备份时请先停止服务，避免写入冲突。
