# Telegram频道/群组管理系统 - 需求文档

## 1. 项目概述

### 1.1 项目目标

开发一个桌面Web管理系统，用于管理多个Telegram用户账号，在用户自己的频道和群组中实现自动化消息发送和评论功能。

### 1.2 目标用户

- Telegram频道/群组所有者
- 需要管理多个账号的内容运营人员
- 需要定时发布内容的营销人员

### 1.3 使用场景

- 在自己的群组中定时发送消息，活跃群组氛围
- 自动评论自己频道的消息，增加互动
- 使用多个账号分散操作，避免单一账号压力
- 通过模板话术实现内容多样化

## 2. 功能需求

### 2.1 账号管理

**用户故事**：作为管理员，我需要管理多个Telegram账号，以便分散操作避免限制。

**验收标准**：

- 支持添加多个Telegram用户账号
- 使用手机号 + 验证码登录
- 支持两步验证密码输入
- 显示账号状态（在线/离线/受限）
- 支持删除账号
- 账号信息持久化存储
- 显示账号基本信息（用户名、手机号、ID）

### 2.2 群组/频道管理

**用户故事**：作为管理员，我需要配置要操作的群组和频道，以便系统知道在哪里发送消息。

**验收标准**：

- 支持添加群组（通过群组链接或ID）
- 支持添加频道（通过频道链接或ID）
- 显示群组/频道基本信息（名称、成员数）
- 支持启用/禁用特定群组/频道
- 支持删除群组/频道配置

### 2.3 消息模板管理

**用户故事**：作为管理员，我需要创建和管理消息模板，以便系统发送多样化的内容。

**验收标准**：

- 支持创建文本消息模板
- 支持模板分类（群组消息、频道评论）
- 支持模板变量（如时间、随机数等）
- 支持启用/禁用模板
- 支持编辑和删除模板
- 模板预览功能

### 2.4 自动发言功能

**用户故事**：作为管理员，我需要在指定群组中自动发送消息，以便活跃群组氛围。

**验收标准**：

- 支持配置发送频率（默认20分钟一次）
- 从模板库随机选择消息内容
- 支持配置发送时间段（如工作时间）
- 支持随机延迟（±5分钟）
- 支持多账号轮换发送
- 记录发送历史
- 支持手动触发发送

### 2.5 自动评论功能

**用户故事**：作为管理员，我需要自动评论频道消息，以便增加内容互动。

**验收标准**：

- 监控指定频道的新消息
- 检测到新消息后自动评论
- 评论延迟随机化（1-10分钟）
- 从评论模板库随机选择内容
- 支持配置评论概率（不是每条都评论）
- 记录评论历史
- 支持启用/禁用自动评论

### 2.6 任务调度

**用户故事**：作为管理员，我需要灵活控制任务的启动和停止，以便按需管理系统。

**验收标准**：

- 支持启动/停止群组发言任务
- 支持启动/停止频道评论任务
- 显示任务运行状态
- 显示下次执行时间
- 支持任务配置修改
- 任务执行日志记录

### 2.7 风控机制

**用户故事**：作为管理员，我需要系统自动处理速率限制，以便避免账号被封禁。

**验收标准**：

- 严格遵守每秒1条消息限制
- 实现FloodWait错误自动处理
- 遇到429错误时自动等待
- 账号健康度监控
- 异常行为告警
- 支持手动设置保守模式（更低频率）

### 2.8 Web管理界面

**用户故事**：作为管理员，我需要一个直观的Web界面，以便轻松管理所有功能。

**验收标准**：

- 响应式设计，支持桌面浏览器
- 账号管理页面
- 群组/频道管理页面
- 消息模板管理页面
- 任务控制面板
- 实时日志查看
- 统计数据展示（发送数、成功率等）
- 系统设置页面

### 2.9 日志与统计

**用户故事**：作为管理员，我需要查看系统运行日志和统计数据，以便了解系统状态。

**验收标准**：

- 实时日志显示
- 日志级别过滤（信息/警告/错误）
- 操作历史记录
- 统计数据：
  - 今日发送消息数
  - 今日评论数
  - 成功率
  - 账号状态统计
- 支持导出日志

## 3. 非功能需求

### 3.1 性能要求

- 系统响应时间 < 2秒
- 支持同时管理至少10个账号
- 数据库查询优化

### 3.2 安全要求

- 账号凭证加密存储
- API密钥安全管理
- 本地部署，数据不上传云端
- 会话管理安全

### 3.3 可用性要求

- 界面简洁直观
- 操作流程清晰
- 提供操作提示和帮助文档
- 错误信息友好

### 3.4 可维护性要求

- 代码模块化
- 完善的错误处理
- 详细的日志记录
- 配置文件化

### 3.5 合规性要求

- 仅用于用户自己的频道/群组
- 遵守Telegram服务条款
- 实现合理的速率限制
- 提供使用说明和免责声明

## 4. 技术约束

### 4.1 开发技术栈

- 后端：Node.js + TypeScript
- 前端：React + TypeScript
- 数据库：SQLite
- Telegram库：GramJS 或 tdl

### 4.2 部署要求

- 本地部署
- 支持Windows/macOS/Linux
- 无需外部依赖服务

### 4.3 Telegram API限制

- 遵守官方速率限制
- 处理FloodWait错误
- 实现重试机制

## 5. 风险与限制

### 5.1 技术风险

- Telegram API变更
- 账号可能被限制
- 网络连接不稳定

### 5.2 使用限制

- 仅限合法用途
- 需要用户自己的账号
- 需要遵守平台规则

### 5.3 缓解措施

- 实现完善的错误处理
- 提供详细的使用文档
- 保守的默认配置
- 账号健康监控

## 6. 未来扩展

### 6.1 可能的功能扩展

- 支持发送图片/视频
- 智能回复功能
- 数据分析和报表
- 多语言支持
- 云端同步配置

### 6.2 优先级

- P0：核心功能（账号管理、消息发送、风控）
- P1：管理界面、任务调度
- P2：统计分析、高级配置
- P3：未来扩展功能
